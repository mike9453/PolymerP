# 197 種 SMARTS 規則與註解
raw_smarts_annotated = [
    # Carbon skeleton
    ("[CX4]", "sp3碳"),
    ("[CX3]=[CX3]", "sp2碳雙鍵"),
    ("[CX2]#[CX2]", "sp碳三鍵"),
    ("c", "芳香碳"),
    ("[CX3]=[CX2]=[CX3]", "共軛雙鍵"),
    ("[CX4H3][#6]", "甲基"),
    ("[CX4H2]([#6])[#6]", "亞甲基"),
    ("[CX4H1]([#6])([#6])[#6]", "三級碳"),
    ("[CX4]([#6])([#6])([#6])[#6]", "四級碳"),
    ("[CH3]", "甲基 (CH3)"),
    ("[CH2][CH3]", "乙基"),
    ("[CH]=[CH2]", "乙烯"),
    ("[C]#[C]", "乙炔"),
    ("[CH0]", "無氫碳"),
    ("[CH1]", "一氫碳"),
    ("[CH2]", "亞甲基"),
    
    # Carbonyl groups
    ("[CX3]=[OX1]", "羰基"),
    ("[$([CX3]=[OX1]),$([CX3+]-[OX1-])]", "帶電羰基"),
    ("[CX3H1](=O)[#6]", "醛"),
    ("[#6][CX3](=O)[#6]", "酮"),
    ("[CX3](=O)[OX2H1]", "羧酸"),
    ("[CX3](=O)[OX1H0-,OX2H1]", "酸與其共軛鹼"),
    ("[CX3](=O)[OX2H0][#6]", "酯"),
    ("[CX3](=O)[F,Cl,Br,I]", "醯鹵"),
    ("[CX3](=O)[NX3;H2,H1;!$(NC=O)]", "醯胺"),
    ("[CX3](=O)[NX3][CX3](=O)", "脲"),
    ("[NX3][CX3]=[NX3+]", "腙類"),
    ("[CX3](=O)[O-]", "羧酸陰離子"),
    ("[CX3](=[OX1])(O)O", "草酸"),
    ("C[OX2][CX3](=[OX1])[OX2]C", "乙醯乙酸酯"),
    
    # Oxygen containing
    ("[OX2H][#6]", "醇"),
    ("[OX2H][CX4H2]", "伯醇"),
    ("[OX2H][CX4H]", "仲醇"),
    ("[OD2]([#6])[#6]", "醚"),
    ("[OX2]([CX4])[CX4]", "對稱醚"),
    ("[OX2H][c]", "苯酚"),
    ("[OX2,OX1-][OX2,OX1-]", "過氧化物"),
    ("[OH]-*=[!#6]", "烯醇"),
    
    # Nitrogen containing
    ("[NX3;H2,H1;!$(NC=O)]", "胺"),
    ("[N;$(N-[#6])]", "胺類"),
    ("[N;H2;D1]", "一級胺"),
    ("[N;H1;D2]", "二級胺"),
    ("[N;H0;D3]", "三級胺"),
    ("[NX3][OX1H]", "羥胺"),
    ("[NX1]#[CX2]", "腈"),
    ("[CX1-]#[NX2+]", "異腈"),
    ("[$([NX3](=O)=O),$([NX3+](=O)[O-])][!#8]", "硝基"),
    ("[NX2]=[OX1]", "亞硝基"),
    ("[NX3,NX4+][CX3](=[OX1])[OX2,OX1-]", "胺基酸類"),
    ("[NX3][CX3](=[OX1])[OX2H0]", "酰胺類"),
    ("[NX3,NX4+][CX3](=[OX1])[OX2H,OX1-]", "中性或負電酰胺"),
    ("[NX3][CX3]=[NX3+]", "亞胺"),
    
    # Sulfur containing
    ("[SX2H]", "硫醇"),
    ("[#16X2H]", "二價硫"),
    ("[#16X2]=O", "硫酮"),
    ("CS", "硫代醇"),
    ("CSC", "硫醚"),
    ("CSSC", "雙硫鍵"),
    ("[S](=O)(=O)(Cl)", "磺酰氯"),
    ("[SX4](=O)(=O)([#6])[OX2H]", "磺酸"),
    ("[SX4]([NX3])(=O)(=O)[#6]", "磺醯胺"),
    ("[SX3]=[OX1]", "亞硫酸酯"),
    
    # Phosphorus
    ("P", "磷原子"),
    ("P(=O)(O)(O)", "磷酸"),
    ("[P](=O)([OX2][#6])([O][H0,OH])", "磷酸酯"),
    ("[P+]([OX1-])([OX2][#6])([O][H0,OH])", "磷酸根"),
    
    # Halogen
    ("[F,Cl,Br,I]", "鹵素"),
    ("[F,Cl,Br,I]-!@[#6]", "鹵代烷"),
    ("[ClX1][CX4]", "氯烷"),
    ("[FX1][CX4]", "氟烷"),
    ("[BrX1][CX4]", "溴烷"),
    ("[IX1][CX4]", "碘烷"),
    
    # Acid/base and hydrogen bonding
    ("[CX3](=O)[OX2H,OX1H0-]", "酸/共軛鹼"),
    ("+1~*~*~[-1]", "離子對"),
    ("[!$([#6,H0,-,-2,-3])]", "非碳陰離子"),
    ("[!H0;#7,#8,#9]", "H-bond接受體"),
    
    # Aromatic & ring
    ("c1ccccc1", "苯環"),
    ("c1ccncc1", "吡啶"),
    ("c1cccnc1", "吡啶異構物"),
    ("c1ccccn1", "吡啶另一異構"),
    ("c1ccccc1O", "苯酚"),
    ("c1ccccc1N", "苯胺"),
    ("c1ccccc1Cl", "氯苯"),
    ("n1ccccc1", "吡咯"),
    ("n1cccnc1", "嘧啶"),
    ("c1ncccc1", "吡嗪"),
    ("c1nc[nH]cc1", "嘌呤"),
    
    # Topological / ring strain
    ("[cX3](:*):*", "芳香環"),
    ("*!@*", "非環鍵"),
    ("[AR0]~[AR0]~[AR0]", "非芳香鏈"),
    ("[X4;R2;r4,r5,r6](@[r4,r5,r6])(@[r4,r5,r6])@[r4,r5,r6]", "小環烷烴"),
    
    # Extras to reach ~197
    ("[C;D3]([O])([N])[H]", "氨基醇"),
    ("[C;D2]([F,Cl,Br,I])[F,Cl,Br,I]", "二鹵代烷"),
    ("[CH]=C([CH3])[CH3]", "異丙烯"),
    ("CC#N", "乙腈"),
    ("[CH2]CO", "乙醇"),
    ("[CH2]C(=O)O", "醋酸根"),
    ("[CH2][OH]", "甲醇"),
    ("[CH2][NH2]", "甲胺"),
    ("CC(=O)OC", "乙酸甲酯"),
    ("N#N", "氮氣"),
]

import pandas as pd
import ace_tools as tools

# 展示資料
df_197 = pd.DataFrame(raw_smarts_annotated, columns=["SMARTS", "說明"])
tools.display_dataframe_to_user(name="197種 SMARTS 模式", dataframe=df_197)

